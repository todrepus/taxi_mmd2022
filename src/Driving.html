<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Claytn_Taxi</title>
    <link href="https://fonts.googleapis.com/css?family=Oxygen:300,400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700" rel="stylesheet">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/flexslider.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/Basic-Frame.css">
    <script src="js/modernizr-2.6.2.min.js"></script>

	<script type='module' src="js/session.js"></script>
    <script type='module' src="js/user.js"></script>
    <script type='module' src='js/reserv.js'></script>
    <script type='module' src="js/payment.js"></script>

	<!-- 블록체인 로그인 되어있는지 체크-->
	<script>
		window.onload = async() => {
			if(Session.auth.wallet_address){ // 지갑주소가 존재한다면,
				if (Session.auth.userType == 'Client'){
					try{ // 이미 가입되어있는 경우, 
						await User.update(); // 유저정보 업데이트.
						location.href = 'index_client.html';
					}catch (error){
						Session.handleLogout();
					}
				}else if (Session.auth.userType == 'Driver'){
					try{ // 이미 가입되어있는 경우,
						await Driver.update();
					}catch (error){
						Session.handleLogout();
					}
                }
                if (!Driver.driving) {
                    
                    location.href = 'driver_request_list.html';
                }

                await Reserv.update(Driver.target);
                if (Reserv.data.end != 0){
                    location.href = 'Arrived.html';
                }
                $('#start_point').text(Reserv.data.start_point);
                $('#dest_point').text(Reserv.data.dest_point);
                await User.update(Driver.target);
                $('#name').text(User.name);
                $('#phone_number').text(User.phone_number);
			}else{ 
				location.href = 'index.html';
			}
		}
    </script>

</head>

<body>
    <div class="fh5co-loader"></div>

    <div id="page">
        <nav class="fh5co-nav" role="navigation">
            <div class="container-wrap">
                <div class="top-menu">
                    <div class="row">
                        <div class="col-xs-2">
                            <div id="fh5co-logo"><a href="index.html">Taxi-driver</a></div>
                        </div>
                        <div class="col-xs-10 text-right menu-1">
                            <ul>
                                <li class="active"><a href="index.html">Home</a></li>
                                <li><a href="work.html">Work</a></li>
                                <li class="has-dropdown">
                                    <a href="blog.html">Claytn</a>
                                    <ul class="dropdown">
                                        <li><a href="#">Introduction</a></li>
                                        <li><a href="#">Claytnscope</a></li>
                                        <li><a href="#">Contact</a></li>
                                        <li><a href="#">API</a></li>
                                    </ul>
                                </li>
                                <li><a href="about.html">About</a></li>
                                <li><a href="contact.html">Contact</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        <div class="container-style">
            <div class="container-loading">
                <p style="font-size: 25px;">운행 중&nbsp;</p>
                <div class="loading">
                    <span></span>   <!--1. span은 하나의 원이다. -->
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div class="">
                <ul style="list-style: none; margin: 0; padding: 0;">
                    <li id='name'>손님 이름: XXX님</li>
                    <li id='phone_number'>전화번호: 010xxxxxxxx</li>
                    <li id='start_point'>손님 위치: 서울특별시 광진구 능동로 209 세종대학교</li>
                    <li id='dest_point'>목적지: 서울특별시 종로구 새문안로 55</li>
                </ul>
            </div>
            <div class="">
                <button type="button" onclick="location.href='Arrived.html'" class="btn btn-lg btn-success">도착 완료</button>
            </div>
        </div>
        <div class="gototop js-top">
            <a href="#" class="js-gotop"><i class="icon-arrow-up2"></i></a>
        </div>
    </div>
        <!-- jQuery -->
        <script src="js/jquery.min.js"></script>
        <!-- jQuery Easing -->
        <script src="js/jquery.easing.1.3.js"></script>
        <!-- Bootstrap -->
        <script src="js/bootstrap.min.js"></script>
        <!-- Waypoints -->
        <script src="js/jquery.waypoints.min.js"></script>
        <!-- Flexslider -->
        <script src="js/jquery.flexslider-min.js"></script>
        <!-- Magnific Popup -->
        <script src="js/jquery.magnific-popup.min.js"></script>
        <script src="js/magnific-popup-options.js"></script>
        <!-- Counters -->
        <script src="js/jquery.countTo.js"></script>
        <!-- Main -->
        <script src="js/main.js"></script>
</body>